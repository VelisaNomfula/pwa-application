(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b185274"],{"6c18":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,o,i=n("60ac");(function(t){t["BACK_TO_SIGN_IN"]="Back to Sign In",t["CHANGE_PASSWORD_ACTION"]="Change",t["CHANGE_PASSWORD"]="Change Password",t["CODE_LABEL"]="Verification code",t["CODE_PLACEHOLDER"]="Enter code",t["CONFIRM_SIGN_UP_CODE_LABEL"]="Confirmation Code",t["CONFIRM_SIGN_UP_CODE_PLACEHOLDER"]="Enter your code",t["CONFIRM_SIGN_UP_HEADER_TEXT"]="Confirm Sign up",t["CONFIRM_SIGN_UP_LOST_CODE"]="Lost your code?",t["CONFIRM_SIGN_UP_RESEND_CODE"]="Resend Code",t["CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT"]="Confirm",t["CONFIRM_SMS_CODE"]="Confirm SMS Code",t["CONFIRM_TOTP_CODE"]="Confirm TOTP Code",t["CONFIRM"]="Confirm",t["CREATE_ACCOUNT_TEXT"]="Create account",t["EMAIL_LABEL"]="Email Address *",t["EMAIL_PLACEHOLDER"]="Enter your email address",t["FORGOT_PASSWORD_TEXT"]="Forgot your password?",t["LESS_THAN_TWO_MFA_VALUES_MESSAGE"]="Less than two MFA types available",t["NEW_PASSWORD_LABEL"]="New password",t["NEW_PASSWORD_PLACEHOLDER"]="Enter your new password",t["NO_ACCOUNT_TEXT"]="No account?",t["USERNAME_REMOVE_WHITESPACE"]="Username cannot contain whitespace",t["PASSWORD_REMOVE_WHITESPACE"]="Password cannot start or end with whitespace",t["PASSWORD_LABEL"]="Password *",t["PASSWORD_PLACEHOLDER"]="Enter your password",t["PHONE_LABEL"]="Phone Number *",t["PHONE_PLACEHOLDER"]="(555) 555-1212",t["QR_CODE_ALT"]="qrcode",t["RESET_PASSWORD_TEXT"]="Reset password",t["RESET_YOUR_PASSWORD"]="Reset your password",t["SELECT_MFA_TYPE_HEADER_TEXT"]="Select MFA Type",t["SELECT_MFA_TYPE_SUBMIT_BUTTON_TEXT"]="Verify",t["SEND_CODE"]="Send Code",t["SUBMIT"]="Submit",t["SETUP_TOTP_REQUIRED"]="TOTP needs to be configured",t["SIGN_IN_ACTION"]="Sign In",t["SIGN_IN_HEADER_TEXT"]="Sign in to your account",t["SIGN_IN_TEXT"]="Sign in",t["SIGN_IN_WITH_AMAZON"]="Sign in with Amazon",t["SIGN_IN_WITH_AUTH0"]="Sign in with Auth0",t["SIGN_IN_WITH_AWS"]="Sign in with AWS",t["SIGN_IN_WITH_FACEBOOK"]="Sign in with Facebook",t["SIGN_IN_WITH_GOOGLE"]="Sign in with Google",t["SIGN_OUT"]="Sign Out",t["SIGN_UP_EMAIL_PLACEHOLDER"]="Email",t["SIGN_UP_HAVE_ACCOUNT_TEXT"]="Have an account?",t["SIGN_UP_HEADER_TEXT"]="Create a new account",t["SIGN_UP_PASSWORD_PLACEHOLDER"]="Password",t["SIGN_UP_SUBMIT_BUTTON_TEXT"]="Create Account",t["SIGN_UP_USERNAME_PLACEHOLDER"]="Username",t["SUCCESS_MFA_TYPE"]="Success! Your MFA Type is now:",t["TOTP_HEADER_TEXT"]="Scan then enter verification code",t["TOTP_LABEL"]="Enter Security Code:",t["TOTP_ISSUER"]="AWSCognito",t["TOTP_SETUP_FAILURE"]="TOTP Setup has failed",t["TOTP_SUBMIT_BUTTON_TEXT"]="Verify Security Token",t["TOTP_SUCCESS_MESSAGE"]="Setup TOTP successfully!",t["UNABLE_TO_SETUP_MFA_AT_THIS_TIME"]="Failed! Unable to configure MFA at this time",t["USERNAME_LABEL"]="Username *",t["USERNAME_PLACEHOLDER"]="Enter your username",t["VERIFY_CONTACT_EMAIL_LABEL"]="Email",t["VERIFY_CONTACT_HEADER_TEXT"]="Account recovery requires verified contact information",t["VERIFY_CONTACT_PHONE_LABEL"]="Phone Number",t["VERIFY_CONTACT_SUBMIT_LABEL"]="Submit",t["VERIFY_CONTACT_VERIFY_LABEL"]="Verify",t["ADDRESS_LABEL"]="Address",t["ADDRESS_PLACEHOLDER"]="Enter your address",t["NICKNAME_LABEL"]="Nickname",t["NICKNAME_PLACEHOLDER"]="Enter your nickname",t["BIRTHDATE_LABEL"]="Birthday",t["BIRTHDATE_PLACEHOLDER"]="Enter your birthday",t["PICTURE_LABEL"]="Picture URL",t["PICTURE_PLACEHOLDER"]="Enter your picture URL",t["FAMILY_NAME_LABEL"]="Family Name",t["FAMILY_NAME_PLACEHOLDER"]="Enter your family name",t["PREFERRED_USERNAME_LABEL"]="Preferred Username",t["PREFERRED_USERNAME_PLACEHOLDER"]="Enter your preferred username",t["GENDER_LABEL"]="Gender",t["GENDER_PLACEHOLDER"]="Enter your gender",t["PROFILE_LABEL"]="Profile URL",t["PROFILE_PLACEHOLDER"]="Enter your profile URL",t["GIVEN_NAME_LABEL"]="First Name",t["GIVEN_NAME_PLACEHOLDER"]="Enter your first name",t["ZONEINFO_LABEL"]="Time zone",t["ZONEINFO_PLACEHOLDER"]="Enter your time zone",t["LOCALE_LABEL"]="Locale",t["LOCALE_PLACEHOLDER"]="Enter your locale",t["UPDATED_AT_LABEL"]="Updated At",t["UPDATED_AT_PLACEHOLDER"]="Enter the time the information was last updated",t["MIDDLE_NAME_LABEL"]="Middle Name",t["MIDDLE_NAME_PLACEHOLDER"]="Enter your middle name",t["WEBSITE_LABEL"]="Website",t["WEBSITE_PLACEHOLDER"]="Enter your website",t["NAME_LABEL"]="Full Name",t["NAME_PLACEHOLDER"]="Enter your full name",t["PHOTO_PICKER_TITLE"]="Picker Title",t["PHOTO_PICKER_HINT"]="Ancillary text or content may occupy this space here",t["PHOTO_PICKER_PLACEHOLDER_HINT"]="Placeholder hint",t["PHOTO_PICKER_BUTTON_TEXT"]="Button",t["IMAGE_PICKER_TITLE"]="Add Profile Photo",t["IMAGE_PICKER_HINT"]="Preview the image before upload",t["IMAGE_PICKER_PLACEHOLDER_HINT"]="Tap to image select",t["IMAGE_PICKER_BUTTON_TEXT"]="Upload",t["PICKER_TEXT"]="Pick a file",t["TEXT_FALLBACK_CONTENT"]="Fallback Content",t["CONFIRM_SIGN_UP_FAILED"]="Confirm Sign Up Failed",t["SIGN_UP_FAILED"]="Sign Up Failed"})(r||(r={})),function(t){t["CHATBOT_TITLE"]="ChatBot Lex",t["TEXT_INPUT_PLACEHOLDER"]="Write a message",t["VOICE_INPUT_PLACEHOLDER"]="Click mic to speak",t["CHAT_DISABLED_ERROR"]="Error: Either voice or text must be enabled for the chatbot",t["NO_BOT_NAME_ERROR"]="Error: Bot name must be provided to ChatBot"}(o||(o={}));var a=Object.assign(Object.assign(Object.assign({},r),i["a"]),o)},"807c":function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return E})),n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return m})),n.d(e,"g",(function(){return g})),n.d(e,"h",(function(){return A})),n.d(e,"i",(function(){return y})),n.d(e,"j",(function(){return a})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return p})),n.d(e,"m",(function(){return f})),n.d(e,"n",(function(){return _})),n.d(e,"o",(function(){return b})),n.d(e,"p",(function(){return u})),n.d(e,"q",(function(){return T})),n.d(e,"r",(function(){return l})),n.d(e,"s",(function(){return i})),n.d(e,"t",(function(){return s})),n.d(e,"u",(function(){return r}));var r="username",o="email",i="code",a="phone",s="password",c="country-dial-code-select",u="+1",l="amplify-auth-source",d="amplify-authenticator-authState",h="Phone number can not be empty",E="No Auth module found, please ensure @aws-amplify/auth is imported",f="No Storage module found, please ensure @aws-amplify/storage is imported",p="No Interactions module found, please ensure @aws-amplify/interactions is imported",m="SETUP_TOTP",_="User has not set up software token mfa",b="User has not verified software token mfa",T="SUCCESS",S="auth",A="UI Auth",g="ToastAuthError",y="AuthStateChange"},"9b2c":function(t,e,n){"use strict";n.r(e),n.d(e,"amplify_chatbot",(function(){return w}));var r,o,i,a=n("6260"),s=n("36de"),c=n("1f3a"),u=n("2482"),l=n("6c18"),d=n("807c"),h=n("b597"),E=function(t,e,n,r){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?n(t.value):o(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},p=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},m="application/octet-stream",_=16e3,b=2048,T=-10,S=-90,A=.85,g=function(t,e){for(var n=new Float32Array(e),r=0,o=0;o<t.length;o++)n.set(t[o],r),r+=t[o].length;return n},y=function(t,e,n){if(n===e)return t;var r=e/n,o=Math.round(t.length/r),i=new Float32Array(o),a=0,s=0;while(a<i.length){for(var c=Math.round((a+1)*r),u=0,l=0,d=s;d<c&&d<t.length;d++)u+=t[d],l++;i[a]=u/l,a++,s=c}return i},C=function(t,e,n){for(var r=e,o=0;o<n.length;o++,r+=2){var i=Math.max(-1,Math.min(1,n[o]));t.setInt16(r,i<0?32768*i:32767*i,!0)}},O=function(t,e,n){for(var r=0;r<n.length;r++)t.setUint8(e+r,n.charCodeAt(r))},L=function(t,e){var n=2*t.length,r=24,o=8+n,i=12+r+o,a=new ArrayBuffer(i),s=new DataView(a);return O(s,0,"RIFF"),s.setUint32(4,r+o,!0),O(s,8,"WAVE"),O(s,12,"fmt "),s.setUint32(16,r-8,!0),s.setUint16(20,1,!0),s.setUint16(22,1,!0),s.setUint32(24,e,!0),s.setUint32(28,2*e,!0),s.setUint16(32,2,!0),s.setUint16(34,16,!0),O(s,36,"data"),s.setUint32(40,n,!0),C(s,44,t),s},R=function(t,e,n,r){var o=g(t,e),i=y(o,n,r),a=L(i,r),s=new Blob([a],{type:m});return s},v=new s["a"]("AudioRecorder"),I=function(){function t(t){this.streamBuffer=[],this.streamBufferLength=0,this.recording=!1,this.options=t}return t.prototype.init=function(){return E(this,void 0,void 0,(function(){var t=this;return f(this,(function(e){switch(e.label){case 0:return Object(c["b"])().isBrowser?(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,[4,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.audioSupported=!0,t.setupAudioNodes(e)})).catch((function(){return t.audioSupported=!1,Promise.reject("Audio is not supported")}))]):[3,2];case 1:return e.sent(),[3,3];case 2:return this.audioSupported=!1,[2,Promise.reject("Audio is not supported")];case 3:return[2]}}))}))},t.prototype.setupAudioNodes=function(t){return E(this,void 0,void 0,(function(){var e,n,r,o,i=this;return f(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.audioContext.resume()];case 1:return a.sent(),[3,3];case 2:return e=a.sent(),v.error(e),[3,3];case 3:return n=this.audioContext.createMediaStreamSource(t),r=this.audioContext.createScriptProcessor(4096,1,1),r.onaudioprocess=function(t){if(i.recording){var e=t.inputBuffer.getChannelData(0);i.streamBuffer.push(new Float32Array(e)),i.streamBufferLength+=e.length,i.analyse()}},o=this.audioContext.createAnalyser(),o.minDecibels=S,o.maxDecibels=T,o.smoothingTimeConstant=A,n.connect(o),o.connect(r),r.connect(n.context.destination),this.analyserNode=o,[2]}}))}))},t.prototype.startRecording=function(t,e){return E(this,void 0,void 0,(function(){var n,r;return f(this,(function(o){switch(o.label){case 0:if(this.recording||!this.audioSupported)return[2];this.onSilence=t||function(){},this.visualizer=e||function(){},n=this.audioContext,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.resume()];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),v.error(r),[3,4];case 4:return this.start=Date.now(),this.recording=!0,[2]}}))}))},t.prototype.stopRecording=function(){this.audioSupported&&(this.recording=!1)},t.prototype.clear=function(){this.stopRecording(),this.streamBufferLength=0,this.streamBuffer=[]},t.prototype.play=function(t){var e=this;if(t&&this.audioSupported){var n=new Blob([t]);return new Promise((function(t,r){var o=new FileReader;o.onload=function(){e.playbackSource&&e.playbackSource.disconnect(),e.playbackSource=e.audioContext.createBufferSource();var n=function(n){e.playbackSource.buffer=n,e.playbackSource.connect(e.audioContext.destination),e.playbackSource.onended=function(){return t()},e.playbackSource.start(0)},i=function(t){return r(t)};e.audioContext.decodeAudioData(o.result,n,i)},o.onerror=function(){return r()},o.readAsArrayBuffer(n)}))}},t.prototype.stop=function(){this.playbackSource&&this.playbackSource.stop()},t.prototype.analyse=function(){if(this.audioSupported){var t=this.analyserNode;t.fftSize=b;var e=t.fftSize,n=new Uint8Array(e),r=this.options.amplitude,o=this.options.time;t.getByteTimeDomainData(n),this.visualizer(n,e);for(var i=0;i<e;i++){var a=n[i]/128-1;(a>r||a<-1*r)&&(this.start=Date.now())}var s=Date.now(),c=s-this.start;c>o&&this.onSilence()}},t.prototype.exportWAV=function(t){return void 0===t&&(t=_),E(this,void 0,void 0,(function(){var e,n;return f(this,(function(r){return this.audioSupported?(e=this.audioContext.sampleRate,n=R(this.streamBuffer,this.streamBufferLength,e,t),this.clear(),[2,n]):[2]}))}))},t}(),N=function(t,e,n){if(n){if(!Object(c["b"])().isBrowser)throw new Error("Visualization is not supported on non-browsers.");var r=n.getBoundingClientRect(),o=r.width,i=r.height;n.width=o,n.height=i;var a=n.getContext("2d");a.fillStyle="white",a.clearRect(0,0,o,i);var s=function(){a.fillRect(0,0,o,i),a.lineWidth=1;var r=getComputedStyle(document.documentElement).getPropertyValue("--amplify-primary-color");a.strokeStyle=r&&""!==r?r:"#ff9900",a.beginPath();for(var s=1*o/e,c=0,u=0;u<e||u%3===0;u++){var l=t[u]/128,d=l*i/2;0===u?a.moveTo(c,d):a.lineTo(c,d),c+=s}a.lineTo(n.width,n.height/2),a.stroke()};requestAnimationFrame(s)}},P=".bot .dot{background-color:var(--bot-dot-color)}.user .dot{background-color:var(--user-dot-color)}.dot-flashing{width:2.625rem}.dot-flashing .dot{display:inline-block;width:0.625rem;height:0.625rem;border-radius:10rem;opacity:0.65}.dot-flashing .left{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:0s;animation-delay:0s}.dot-flashing .middle{margin-left:0.375rem;margin-right:0.375rem;-webkit-animation:dot-flashing 1s infinite linear alternate;animation:dot-flashing 1s infinite linear alternate;-webkit-animation-delay:0.5s;animation-delay:0.5s}.dot-flashing .right{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}@keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}:host{--width:28.75rem;--height:37.5rem;--header-color:var(--amplify-secondary-color);--header-size:var(--amplify-text-lg);--bot-background-color:rgb(230, 230, 230);--bot-text-color:black;--bot-dot-color:var(--bot-text-color);--user-background-color:var(--amplify-blue);--user-text-color:var(--amplify-white);--user-dot-color:var(--user-text-color)}.amplify-chatbot{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--background-color);border-radius:0.375rem;-webkit-box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;font-family:var(--amplify-font-family);margin-bottom:1rem;width:100%;height:var(--height);max-width:var(--width)}@media (min-width: 672px){.amplify-chatbot{width:var(--width)}}.header{padding:1.25rem 0.375rem 1.25rem 0.375rem;color:var(--header-color);font-size:var(--header-size);font-weight:bold;text-align:center;word-wrap:break-word}.body{border-top:0.0625rem solid rgba(0, 0, 0, 0.05);padding:1.5rem 1rem 0 1rem;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;overflow:auto}.bubble{max-width:100%;padding:0.8em 1.4em;text-align:left;word-wrap:break-word;margin-bottom:0.625rem}.bot{margin-right:auto;background-color:var(--bot-background-color);color:var(--bot-text-color);border-radius:1.5rem 1.5rem 1.5rem 0}.user{margin-left:auto;background-color:var(--user-background-color);color:var(--user-text-color);border-radius:1.5rem 1.5rem 0 1.5rem}.footer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-top:0.062rem solid rgba(0, 0, 0, 0.05);padding-right:0.625rem;min-height:3.125rem}.footer amplify-input{--border:none;--margin:0;-ms-flex-positive:1;flex-grow:1}canvas{margin-left:0.625rem;margin-right:0.625rem;-ms-flex-positive:1;flex-grow:1;height:3.125rem}.icon-button{--icon-height:1.25rem;--icon-fill:var(--amplify-primary-color);--padding:0.625rem;--width:auto}";(function(t){t[t["Initial"]=0]="Initial",t[t["Listening"]=1]="Listening",t[t["SendingText"]=2]="SendingText",t[t["SendingVoice"]=3]="SendingVoice",t[t["Error"]=4]="Error"})(r||(r={})),function(t){t["Bot"]="bot",t["User"]="user"}(o||(o={})),function(t){t[t["Recoverable"]=0]="Recoverable",t[t["Unrecoverable"]=1]="Unrecoverable"}(i||(i={}));var w=function(){function t(t){var e=this;Object(a["k"])(this,t),this.clearOnComplete=!1,this.conversationModeOn=!1,this.botTitle=l["a"].CHATBOT_TITLE,this.voiceEnabled=!1,this.textEnabled=!0,this.silenceTime=1500,this.silenceThreshold=.2,this.messages=[],this.text="",this.chatState=r.Initial,this.messageJSX=function(t){var n=t.map((function(t){return Object(a["i"])("div",{class:"bubble "+t.from},t.content)}));if(e.chatState===r.SendingText||e.chatState===r.SendingVoice){var i=e.chatState===r.SendingText?o.Bot:o.User;n.push(Object(a["i"])("div",{class:"bubble "+i},Object(a["i"])("div",{class:"dot-flashing "+i},Object(a["i"])("span",{class:"dot left"}),Object(a["i"])("span",{class:"dot middle"}),Object(a["i"])("span",{class:"dot right"}))))}return n},this.chatCompleted=Object(a["f"])(this,"chatCompleted",7)}return t.prototype.submitHandler=function(t){this.sendTextMessage()},t.prototype.componentWillLoad=function(){if(!h["a"]||"function"!==typeof h["a"].onComplete)throw new Error(d["l"]);this.validateProps()},t.prototype.componentDidRender=function(){var t=this.element.shadowRoot.querySelector(".body");t.scrollTop=t.scrollHeight},t.prototype.validateProps=function(){var t=this;if(this.voiceEnabled||this.textEnabled)if(this.botName){this.welcomeMessage&&this.appendToChat(this.welcomeMessage,o.Bot),this.voiceEnabled&&(this.audioRecorder=new I({time:this.silenceTime,amplitude:this.silenceThreshold}),this.audioRecorder.init().catch((function(e){t.setError(e,i.Recoverable)})));var e=function(e,n){t.chatCompleted.emit({data:n,err:e}),t.clearOnComplete?t.reset():t.chatState=r.Initial};try{h["a"].onComplete(this.botName,e)}catch(n){this.setError(n,i.Unrecoverable)}}else this.setError(l["a"].NO_BOT_NAME_ERROR,i.Unrecoverable);else this.setError(l["a"].CHAT_DISABLED_ERROR,i.Unrecoverable)},t.prototype.handleSubmit=function(t){t.preventDefault(),this.sendTextMessage()},t.prototype.handleMicButton=function(){var t=this;this.chatState===r.Initial&&(this.audioRecorder.stop(),this.chatState=r.Listening,this.audioRecorder.startRecording((function(){return t.handleSilence()}),(function(e,n){return t.visualizer(e,n)})))},t.prototype.handleSilence=function(){var t=this;this.chatState=r.SendingVoice,this.audioRecorder.stopRecording(),this.audioRecorder.exportWAV().then((function(e){t.sendVoiceMessage(e)}))},t.prototype.handleTextChange=function(t){var e=t.target;this.text=e.value},t.prototype.handleCancelButton=function(){this.audioRecorder.clear(),this.chatState=r.Initial},t.prototype.handleToastClose=function(t){this.error=void 0,t===i.Recoverable&&(this.chatState=r.Initial)},t.prototype.visualizer=function(t,e){var n=this.element.shadowRoot.querySelector("canvas");N(t,e,n)},t.prototype.sendTextMessage=function(){return E(this,void 0,void 0,(function(){var t,e,n;return f(this,(function(a){switch(a.label){case 0:if(0===this.text.length||this.chatState!==r.Initial)return[2];t=this.text,this.text="",this.appendToChat(t,o.User),this.chatState=r.SendingText,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,h["a"].send(this.botName,t)];case 2:return e=a.sent(),[3,4];case 3:return n=a.sent(),this.setError(n,i.Recoverable),[2];case 4:return e.message&&this.appendToChat(e.message,o.Bot),this.chatState=r.Initial,[2]}}))}))},t.prototype.sendVoiceMessage=function(t){return E(this,void 0,void 0,(function(){var e,n,a,s,c=this;return f(this,(function(u){switch(u.label){case 0:e={content:t,options:{messageType:"voice"}},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,h["a"].send(this.botName,e)];case 2:return n=u.sent(),[3,4];case 3:return a=u.sent(),this.setError(a,i.Recoverable),[2];case 4:return this.chatState=r.Initial,s=n.dialogState,n.inputTranscript&&this.appendToChat(n.inputTranscript,o.User),this.appendToChat(n.message,o.Bot),[4,this.audioRecorder.play(n.audioStream).then((function(){c.conversationModeOn&&"Fulfilled"!==s&&"Failed"!==s&&c.chatState===r.Initial&&c.handleMicButton()})).catch((function(t){return c.setError(t,i.Recoverable)}))];case 5:return u.sent(),[2]}}))}))},t.prototype.appendToChat=function(t,e){this.messages=p(this.messages,[{content:t,from:e}])},t.prototype.setError=function(t,e){var n="string"===typeof t?t:t.message;this.chatState=r.Error,this.error={message:n,errorType:e}},t.prototype.reset=function(){this.chatState=r.Initial,this.text="",this.error=void 0,this.messages=[],this.welcomeMessage&&this.appendToChat(this.welcomeMessage,o.Bot),this.audioRecorder&&this.audioRecorder.clear()},t.prototype.listeningFooterJSX=function(){var t=this,e=Object(a["i"])("canvas",{height:"50"}),n=Object(a["i"])("amplify-button",{"data-test":"chatbot-cancel-button",handleButtonClick:function(){return t.handleCancelButton()},class:"icon-button",variant:"icon",icon:"ban"});return[e,n]},t.prototype.footerJSX=function(){var t=this;if(this.chatState===r.Listening)return this.listeningFooterJSX();var e=this.textEnabled?l["a"].TEXT_INPUT_PLACEHOLDER:l["a"].VOICE_INPUT_PLACEHOLDER,n=Object(a["i"])("amplify-input",{placeholder:u["a"].get(e),description:"text",handleInputChange:function(e){return t.handleTextChange(e)},value:this.text,disabled:this.chatState===r.Error||!this.textEnabled}),o=this.voiceEnabled&&Object(a["i"])("amplify-button",{"data-test":"chatbot-mic-button",handleButtonClick:function(){return t.handleMicButton()},class:"icon-button",variant:"icon",icon:"microphone",disabled:this.chatState===r.Error||this.chatState!==r.Initial}),i=this.textEnabled&&Object(a["i"])("amplify-button",{"data-test":"chatbot-send-button",class:"icon-button",variant:"icon",icon:"send",handleButtonClick:function(){return t.sendTextMessage()},disabled:this.chatState===r.Error||this.chatState!==r.Initial});return[n,o,i]},t.prototype.errorToast=function(){var t=this;if(this.error){var e=this.error,n=e.message,r=e.errorType;return Object(a["i"])("amplify-toast",{message:u["a"].get(n),handleClose:function(){return t.handleToastClose(r)}})}},t.prototype.render=function(){var t=this;return Object(a["i"])(a["b"],null,Object(a["i"])("div",{class:"amplify-chatbot"},Object(a["i"])("slot",{name:"header"},Object(a["i"])("div",{class:"header","data-test":"chatbot-header"},u["a"].get(this.botTitle))),Object(a["i"])("div",{class:"body","data-test":"chatbot-body"},this.messageJSX(this.messages)),Object(a["i"])("form",{onSubmit:function(e){return t.handleSubmit(e)}},Object(a["i"])("div",{class:"footer","data-test":"chatbot-footer"},this.footerJSX())),this.errorToast()))},Object.defineProperty(t.prototype,"element",{get:function(){return Object(a["h"])(this)},enumerable:!1,configurable:!0}),t}();w.style=P}}]);
//# sourceMappingURL=chunk-3b185274.90171871.js.map